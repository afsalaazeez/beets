# Test generated by RoostGPT for test beetbox-api using AI Type Open AI and AI Model gpt-3.5-turbo-16k

# RoostTestHash=70199667a6

config:
  target: "{{ $processEnvironment.API_HOST }}"
  plugins:
    expect: {}
  payload:
    - products_get_others.csv:
        skipHeader: true

scenarios:
  - name: Test API endpoint /products
    flow:
      - post:
          url: "/products"
          headers:
            Content-Type: application/json
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          payload:
            id: 1
            name: "apple"
            description: "apple"
            price: 50
          expect:
            statusCode: 400
            bodyContains: "Missing required field: name"

      - think: 2

      - post:
          url: "/products"
          headers:
            Content-Type: application/json
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          payload:
            id: 1
            name: "apple"
            description: "apple"
            price: 50
          expect:
            statusCode: 200

      - think: 2

      - post:
          url: "/products"
          headers:
            Content-Type: application/json
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          payload:
            id: 1
            name: "apple"
            description: "apple"
            price: 50
          expect:
            statusCode:
              - 404
              - 500
              - 401

      - think: 2

      - post:
          url: "/products"
          headers:
            Content-Type: application/json
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          payload:
            id: 1
            name: "apple"
            description: "apple"
            price: 50
          expect:
            statusCode: 200
            body:
              - id: 1
                name: "apple"
                description: "apple"
                price: 50

      - think: 2

      - post:
          url: "/products"
          headers:
            Content-Type: application/json
            Authorization: "Bearer invalidToken"
          payload:
            id: 1
            name: "apple"
            description: "apple"
            price: 50
          expect:
            statusCode: 401

      - think: 2

      - post:
          url: "/products"
          headers:
            Content-Type: application/json
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          payload:
            id: 1
            name: "apple"
            description: "apple"
            price: 50
          expect:
            statusCode: 200
            body:
              - id: 1
                name: "apple"
                description: "apple"
                price: 50
              - id: 2
                name: "1"
                description: "apple"
                price: 50

      - think: 2

      - post:
          url: "/products"
          headers:
            Content-Type: application/json
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          payload:
            id: 1
            name: "apple"
            description: "apple"
            price: 50
          expect:
            statusCode: 200
            headers:
              Content-Type: "application/json"
